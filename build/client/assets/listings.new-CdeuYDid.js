import{w as L,u as F,a as D,c as M,r as i,j as e,F as I}from"./chunk-JZWAC4HX-Wpy6LLBq.js";import{H as O}from"./Header-DbNBnIdE.js";import{g as j,a as H,b as R,E,H as P}from"./listing-rules-CouRL6vW.js";const W=()=>[{title:"Create Listing - RunStay Exchange"}],K=L(function(){const{user:a,events:h,googlePlacesApiKey:y}=F(),r=D(),p=M(),[t,m]=i.useState("room"),[o,v]=i.useState(""),[A,f]=i.useState(!1),[n,N]=i.useState(null),[w,k]=i.useState(null),[_,b]=i.useState(!1),[C,S]=i.useState(null);i.useEffect(()=>{r!=null&&r.success&&(r!=null&&r.listingId)&&(S(r.listingId),b(!0))},[r]),i.useEffect(()=>{const s=document.getElementById("description");if(s&&o==="other"){s.setCustomValidity(s.value?"":"Required");const l=()=>{s.setCustomValidity(s.value?"":"Required")};return s.addEventListener("input",l),()=>s.removeEventListener("input",l)}},[o]);const d=(()=>{if(!(n!=null&&n.event_date))return{min:void 0,max:void 0};const s=new Date(n.event_date),l=new Date(s);l.setDate(l.getDate()-7);const c=new Date(s);return c.setDate(c.getDate()+7),{min:l.toISOString().split("T")[0],max:c.toISOString().split("T")[0]}})(),x=j(a.user_type,"rooms"),u=j(a.user_type,"bibs"),T=H(a.user_type),g=R(a.user_type,w,t);return e.jsxs("div",{className:"min-h-full bg-gray-50",children:[e.jsx(O,{user:a}),e.jsx("div",{className:"min-h-screen bg-cover bg-center bg-no-repeat",style:{backgroundImage:"url('/new-listing.jpg')"},children:e.jsxs("main",{className:"mx-auto max-w-2xl px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8 rounded-xl bg-white/70 backdrop-blur-sm p-4 inline-block shadow-[0_2px_8px_rgba(0,0,0,0.15)]",children:[e.jsx("h1",{className:"font-display text-3xl font-bold text-gray-900",children:"Create a Listing"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Share your available rooms or bibs with the community"})]}),e.jsx("div",{className:"rounded-2xl bg-white/70 backdrop-blur-sm p-6 sm:p-8 shadow-[0_2px_8px_rgba(0,0,0,0.15)]",children:e.jsxs(I,{method:"post",className:"space-y-8",onSubmit:()=>f(!0),children:[(r==null?void 0:r.error)&&e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-700",children:r.error}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"What are you offering?"}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-3",children:[e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg bg-white p-4 shadow-sm focus:outline-none transition-all hover:ring-2 hover:ring-blue-300 has-[:checked]:bg-blue-100 has-[:checked]:ring-2 has-[:checked]:ring-blue-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"room",className:"sr-only",defaultChecked:!0,onChange:s=>m(s.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Room Only"})]})]}),e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg bg-white p-4 shadow-sm focus:outline-none transition-all hover:ring-2 hover:ring-purple-300 has-[:checked]:bg-purple-100 has-[:checked]:ring-2 has-[:checked]:ring-purple-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"bib",className:"sr-only",onChange:s=>m(s.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Bib Only"})]})]}),e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg bg-white p-4 shadow-sm focus:outline-none transition-all hover:ring-2 hover:ring-green-300 has-[:checked]:bg-green-100 has-[:checked]:ring-2 has-[:checked]:ring-green-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"room_and_bib",className:"sr-only",onChange:s=>m(s.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Room + Bib"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Running Event"}),e.jsx(E,{events:h,onSelectEvent:s=>{const l=h.find(c=>c.id===s);N(l)}})]}),(t==="room"||t==="room_and_bib")&&e.jsxs("div",{className:"space-y-4",id:"roomFields",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Room Details"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"label",children:"Hotel"}),e.jsx(P,{apiKey:y,eventCity:n==null?void 0:n.country,eventCountry:n==null?void 0:n.country,onSelectHotel:s=>{}})]}),e.jsx("div",{children:" "}),e.jsx("div",{children:" "}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"roomCount",className:"label",children:["Number of rooms",x!==null&&a.user_type==="tour_operator"&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(max ",x," for your account)"]})]}),a.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-lg font-bold text-2xl shadow-[0_2px_8px_rgba(0,0,0,0.15)] ${t==="room"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:"1"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Private users can list 1 room only"})]}),e.jsx("input",{type:"hidden",name:"roomCount",value:"1"})]}):e.jsx("input",{type:"number",id:"roomCount",name:"roomCount",min:"1",max:x||void 0,placeholder:"e.g. 2",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"roomType",className:"label",children:"Room type"}),e.jsxs("select",{id:"roomType",name:"roomType",className:"input",onChange:s=>v(s.target.value),children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"single",children:"Single"}),e.jsx("option",{value:"double",children:"Double"}),e.jsx("option",{value:"twin",children:"Twin"}),e.jsx("option",{value:"twin_shared",children:"Twin Shared"}),e.jsx("option",{value:"double_single_use",children:"Double Single Use"}),e.jsx("option",{value:"triple",children:"Triple"}),e.jsx("option",{value:"quadruple",children:"Quadruple"}),e.jsx("option",{value:"other",children:"Other * (specify)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"checkIn",className:"label",children:"Check-in date"}),e.jsx("input",{type:"date",id:"checkIn",name:"checkIn",placeholder:"dd/mm/yyyy",min:d.min,max:d.max,className:"input"}),n&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Event date: ",new Date(n.event_date).toLocaleDateString()," (±7 days)"]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"checkOut",className:"label",children:"Check-out date"}),e.jsx("input",{type:"date",id:"checkOut",name:"checkOut",placeholder:"dd/mm/yyyy",min:d.min,max:d.max,className:"input"})]})]})]}),(t==="bib"||t==="room_and_bib")&&e.jsxs("div",{className:"space-y-4",id:"bibFields",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Bib Transfer Details"}),a.user_type==="private"&&e.jsx("div",{className:`rounded-lg p-4 ${t==="bib"?"bg-purple-50 border border-purple-200":"bg-green-50 border border-green-200"}`,children:e.jsxs("p",{className:`text-sm ${t==="bib"?"text-purple-800":"text-green-800"}`,children:[e.jsx("strong",{children:"Important:"})," RunOot facilitates connections for legitimate bib transfers only. Direct sale of bibs may violate event regulations."]})}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"bibCount",className:"label",children:["Number of bibs",u!==null&&a.user_type==="tour_operator"&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(max ",u," for your account)"]})]}),a.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-lg font-bold text-2xl shadow-[0_2px_8px_rgba(0,0,0,0.15)] ${t==="bib"?"bg-purple-100 text-purple-700":"bg-green-100 text-green-700"}`,children:"1"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Private users can list 1 bib only"})]}),e.jsx("input",{type:"hidden",name:"bibCount",value:"1"})]}):e.jsx("input",{type:"number",id:"bibCount",name:"bibCount",min:"1",max:u||void 0,placeholder:"e.g. 1",className:"input w-full sm:w-48"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"transferType",className:"label",children:["Transfer Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),a.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-2 px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:"Official Organizer Name Change"}),e.jsx("input",{type:"hidden",name:"transferType",value:"official_process"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"How the bib will be transferred to the new participant"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{id:"transferType",name:"transferType",className:"input",onChange:s=>k(s.target.value),children:[e.jsx("option",{value:"",children:"Select transfer method"}),T.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"How the bib will be transferred to the new participant"})]})]}),g.showAssociatedCosts&&e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"associatedCosts",className:"label",children:["Associated Costs (€) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",id:"associatedCosts",name:"associatedCosts",min:"0",step:"0.01",placeholder:"e.g. 50",className:"input [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Official name change fee from the event organizer"})]}),g.showPackageInfo&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx("strong",{children:"Package Transfer:"})," The bib is included in your travel package. All costs are included in the package price."]})})]}),!(a.user_type==="private"&&t==="bib")&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Price"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"label",children:"Price (€)"}),e.jsx("input",{type:"number",id:"price",name:"price",min:"0",step:"0.01",placeholder:"Empty = Contact for price",className:"input [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),(t==="room"||t==="room_and_bib")&&e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"priceNegotiable",className:"h-4 w-4 rounded border-gray-300 text-brand-600 focus:ring-brand-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Price is negotiable"})]})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"description",className:"label",children:[a.user_type==="private"&&t==="bib"?"Notes":"Additional details"," ",e.jsx("span",{className:o==="other"?"text-red-500":"text-gray-400",children:o==="other"?"(required)":"(optional)"})]}),e.jsx("textarea",{id:"description",name:"description",rows:4,placeholder:"Any other information runners should know...",className:`input ${o==="other"?"required:border-red-500 invalid:border-red-500 focus:invalid:ring-red-500":""}`,required:o==="other"})]}),e.jsx("div",{className:"flex gap-4 pt-4",children:e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Create Listing"})})]})})]})}),_&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"}),e.jsxs("div",{className:"relative w-full max-w-md rounded-2xl bg-white p-8 shadow-2xl text-center",style:{animation:"fade-in-up 0.3s ease-out"},children:[e.jsx("div",{className:`mx-auto mb-6 flex h-24 w-24 items-center justify-center rounded-full ${t==="room"?"bg-blue-100":t==="bib"?"bg-purple-100":"bg-green-100"}`,style:{animation:"scale-in 0.4s ease-out"},children:e.jsx("svg",{className:`h-12 w-12 ${t==="room"?"text-blue-600":t==="bib"?"text-purple-600":"text-green-600"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"font-display text-2xl font-bold text-gray-900 mb-2",children:"Listing Created!"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Your listing has been published successfully and is now visible to other users."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>p(`/listings/${C}`),className:"btn-primary w-full py-3 rounded-full",children:"View Your Listing"}),a.user_type==="tour_operator"&&e.jsx("button",{onClick:()=>{b(!1),p("/dashboard")},className:"btn bg-gray-100 text-gray-700 hover:bg-gray-200 w-full py-3 rounded-full",children:"Go to Dashboard"})]})]})]})})]})});export{K as default,W as meta};
