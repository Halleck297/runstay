import{w as P,u as B,a as $,c as A,r as n,j as e,F as V}from"./chunk-JZWAC4HX-Dlc7LzsC.js";import{H as z}from"./Header-DiP6E3C1.js";import{g as f,a as W,b as q,E as Y,H as K,R as G,D as N,C as U}from"./listing-rules-BUYIbtOx.js";const te=()=>[{title:"Create Listing - RunStay Exchange"}],re=P(function(){const{user:a,events:g,googlePlacesApiKey:w}=B(),t=$(),b=A(),[r,x]=n.useState("room"),[d,k]=n.useState(""),[Q,C]=n.useState(!1),[i,_]=n.useState(null),[S,L]=n.useState(null),[D,v]=n.useState(!1),[T,F]=n.useState(null),[I,M]=n.useState(null),[E,H]=n.useState("EUR"),[j,R]=n.useState(""),[c,u]=n.useState(null);n.useEffect(()=>{t!=null&&t.success&&(t!=null&&t.listingId)&&(F(t.listingId),v(!0))},[t]),n.useEffect(()=>{const s=document.getElementById("description");if(s&&d==="other"){s.setCustomValidity(s.value?"":"Required");const o=()=>{s.setCustomValidity(s.value?"":"Required")};return s.addEventListener("input",o),()=>s.removeEventListener("input",o)}},[d]);const l=(()=>{if(!(i!=null&&i.event_date))return{min:void 0,max:void 0};const s=new Date(i.event_date),o=new Date(s);o.setDate(o.getDate()-7);const m=new Date(s);return m.setDate(m.getDate()+7),{min:o.toISOString().split("T")[0],max:m.toISOString().split("T")[0]}})(),h=f(a.user_type,"rooms"),p=f(a.user_type,"bibs"),O=W(a.user_type),y=q(a.user_type,S,r);return e.jsxs("div",{className:"min-h-full bg-gray-50",children:[e.jsx(z,{user:a}),e.jsx("div",{className:"min-h-screen bg-cover bg-center bg-no-repeat bg-fixed",style:{backgroundImage:"url('/new-listing.jpg')"},children:e.jsxs("main",{className:"mx-auto max-w-2xl px-4 py-8 pb-8 md:pb-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6 md:mb-8 rounded-xl bg-white/70 backdrop-blur-sm p-3 md:p-4 inline-block shadow-[0_2px_8px_rgba(0,0,0,0.15)]",children:[e.jsx("h1",{className:"font-display text-xl md:text-3xl font-bold text-gray-900",children:"Create a Listing"}),e.jsx("p",{className:"mt-1 md:mt-2 text-sm md:text-base text-gray-600",children:"Share your available rooms or bibs with the community"})]}),e.jsx("div",{className:"rounded-2xl bg-white/90 backdrop-blur-sm p-6 sm:p-8 shadow-[0_2px_8px_rgba(0,0,0,0.15)]",children:e.jsxs(V,{method:"post",className:"space-y-8",onSubmit:()=>C(!0),children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"What are you offering?"}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-3",children:[e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg bg-white p-4 shadow-sm focus:outline-none transition-all hover:ring-2 hover:ring-blue-300 has-[:checked]:bg-blue-100 has-[:checked]:ring-2 has-[:checked]:ring-blue-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"room",className:"sr-only",defaultChecked:!0,onChange:s=>x(s.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Room Only"})]})]}),e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg bg-white p-4 shadow-sm focus:outline-none transition-all hover:ring-2 hover:ring-purple-300 has-[:checked]:bg-purple-100 has-[:checked]:ring-2 has-[:checked]:ring-purple-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"bib",className:"sr-only",onChange:s=>x(s.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Bib Only"})]})]}),e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg bg-white p-4 shadow-sm focus:outline-none transition-all hover:ring-2 hover:ring-green-300 has-[:checked]:bg-green-100 has-[:checked]:ring-2 has-[:checked]:ring-green-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"room_and_bib",className:"sr-only",onChange:s=>x(s.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Room + Bib"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Running Event"}),e.jsx(Y,{events:g,onSelectEvent:s=>{const o=g.find(m=>m.id===s);_(o)},hasError:(t==null?void 0:t.field)==="event"})]}),(r==="room"||r==="room_and_bib")&&e.jsxs("div",{className:"space-y-4",id:"roomFields",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Room Details"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"label",children:"Hotel"}),e.jsx(K,{apiKey:w,eventCity:i==null?void 0:i.country,eventCountry:i==null?void 0:i.country,onSelectHotel:s=>{},hasError:(t==null?void 0:t.field)==="hotel"})]}),e.jsx("div",{children:" "}),e.jsx("div",{children:" "}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"roomCount",className:"label mb-3",children:["Number of rooms",h!==null&&a.user_type==="tour_operator"&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(max ",h," for your account)"]})]}),a.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-lg font-bold text-2xl shadow-[0_2px_8px_rgba(0,0,0,0.15)] ${r==="room"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:"1"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Private users can list",e.jsx("br",{}),"1 room only"]})]}),e.jsx("input",{type:"hidden",name:"roomCount",value:"1"})]}):e.jsx("input",{type:"number",id:"roomCount",name:"roomCount",min:"1",max:h||void 0,placeholder:"e.g. 2",className:"input"})]}),e.jsx(G,{value:d,onChange:k,hasError:(t==null?void 0:t.field)==="roomType"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"checkIn",className:"label mb-3",children:"Check-in"}),e.jsx(N,{id:"checkIn",name:"checkIn",placeholder:"dd/mm/yyyy",minDate:l.min?new Date(l.min):void 0,maxDate:l.max?new Date(l.max):void 0,onChange:s=>M(s)}),i&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Event date: ",new Date(i.event_date).toLocaleDateString()," (±7 days)"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"checkOut",className:"label mb-3",children:"Check-out"}),e.jsx(N,{id:"checkOut",name:"checkOut",placeholder:"dd/mm/yyyy",minDate:I||(l.min?new Date(l.min):void 0),maxDate:l.max?new Date(l.max):void 0})]})]})]}),(r==="bib"||r==="room_and_bib")&&e.jsxs("div",{className:"space-y-4",id:"bibFields",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Bib Transfer Details"}),a.user_type==="private"&&e.jsx("div",{className:`rounded-lg p-4 ${r==="bib"?"bg-purple-50 border border-purple-200":"bg-green-50 border border-green-200"}`,children:e.jsxs("p",{className:`text-sm ${r==="bib"?"text-purple-800":"text-green-800"}`,children:[e.jsx("strong",{children:"Important:"})," runoot facilitates connections for legitimate bib transfers only. Direct sale of bibs may violate event regulations."]})}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"bibCount",className:"label",children:["Number of bibs",p!==null&&a.user_type==="tour_operator"&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(max ",p," for your account)"]})]}),a.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-lg font-bold text-2xl shadow-[0_2px_8px_rgba(0,0,0,0.15)] ${r==="bib"?"bg-purple-100 text-purple-700":"bg-green-100 text-green-700"}`,children:"1"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Private users can list 1 bib only"})]}),e.jsx("input",{type:"hidden",name:"bibCount",value:"1"})]}):e.jsx("input",{type:"number",id:"bibCount",name:"bibCount",min:"1",max:p||void 0,placeholder:"e.g. 1",className:"input w-full sm:w-48"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"transferType",className:"label",children:["Transfer Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),a.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-2 px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:"Official Organizer Name Change"}),e.jsx("input",{type:"hidden",name:"transferType",value:"official_process"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"How the bib will be transferred to the new participant"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{id:"transferType",name:"transferType",className:"input",onChange:s=>L(s.target.value),children:[e.jsx("option",{value:"",children:"Select transfer method"}),O.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"How the bib will be transferred to the new participant"})]})]}),y.showAssociatedCosts&&e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"associatedCosts",className:"label",children:["Associated Costs (€) ",e.jsx("span",{className:"text-gray-400",children:"(optional)"})]}),e.jsx("input",{type:"number",id:"associatedCosts",name:"associatedCosts",min:"0",step:"0.01",placeholder:"e.g. 50",className:"input [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Official name change fee from the event organizer (if applicable)"})]}),y.showPackageInfo&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx("strong",{children:"Package Transfer:"})," The bib is included in your travel package. All costs are included in the package price."]})})]}),!(a.user_type==="private"&&r==="bib")&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Price"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"label mb-3",children:"Amount"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",id:"price",name:"price",min:"0",step:"0.01",placeholder:"",className:"input w-32 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",value:j,onChange:s=>{R(s.target.value),s.target.value||u(null)}}),e.jsx(U,{value:E,onChange:H})]}),e.jsx("p",{className:"mt-1.5 text-sm text-gray-500",children:"Leave empty = Contact for price"})]}),j&&(r==="room"||r==="room_and_bib")&&e.jsxs("div",{className:"mt-4",children:[e.jsx("input",{type:"hidden",name:"priceNegotiable",value:c===!0?"true":"false"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Is the price negotiable?"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>u(c===!0?null:!0),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${c===!0?"bg-green-100 text-green-700 ring-2 ring-green-500 shadow-[0_2px_8px_rgba(0,0,0,0.15)]":"bg-white text-gray-700 shadow-sm hover:ring-2 hover:ring-green-300"}`,children:"Yes"}),e.jsx("button",{type:"button",onClick:()=>u(c===!1?null:!1),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${c===!1?"bg-green-100 text-green-700 ring-2 ring-green-500 shadow-[0_2px_8px_rgba(0,0,0,0.15)]":"bg-white text-gray-700 shadow-sm hover:ring-2 hover:ring-green-300"}`,children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"description",className:"label",children:[a.user_type==="private"&&r==="bib"?"Notes":"Additional details"," ",e.jsx("span",{className:d==="other"?"text-red-500":"text-gray-400",children:d==="other"?"(required)":"(optional)"})]}),e.jsx("textarea",{id:"description",name:"description",rows:4,placeholder:"Any other information runners should know...",className:`input ${d==="other"?"required:border-red-500 invalid:border-red-500 focus:invalid:ring-red-500":""}`,required:d==="other"})]}),(t==null?void 0:t.error)&&e.jsxs("div",{className:"rounded-lg bg-red-50 border border-red-200 p-4 text-sm text-red-700 flex items-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5 text-red-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.error]}),e.jsx("div",{className:"flex gap-4 pt-4",children:e.jsx("button",{type:"submit",className:"btn-primary flex-1 rounded-full",children:"Create Listing"})})]})})]})}),D&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm"}),e.jsxs("div",{className:"relative w-full max-w-md rounded-2xl bg-white p-8 shadow-2xl text-center",style:{animation:"fade-in-up 0.3s ease-out"},children:[e.jsx("div",{className:`mx-auto mb-6 flex h-24 w-24 items-center justify-center rounded-full ${r==="room"?"bg-blue-100":r==="bib"?"bg-purple-100":"bg-green-100"}`,style:{animation:"scale-in 0.4s ease-out"},children:e.jsx("svg",{className:`h-12 w-12 ${r==="room"?"text-blue-600":r==="bib"?"text-purple-600":"text-green-600"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"font-display text-2xl font-bold text-gray-900 mb-2",children:"Listing Submitted!"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Your listing has been submitted and is pending review. We'll notify you once it's approved and visible to other users."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>b(`/listings/${T}`),className:"btn-primary w-full py-3 rounded-full",children:"View Your Listing"}),a.user_type==="tour_operator"&&e.jsx("button",{onClick:()=>{v(!1),b("/dashboard")},className:"btn bg-gray-100 text-gray-700 hover:bg-gray-200 w-full py-3 rounded-full",children:"Go to Dashboard"})]})]})]})})]})});export{re as default,te as meta};
