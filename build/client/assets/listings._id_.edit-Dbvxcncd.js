import{w as F,u as L,a as S,r as d,j as e,L as y,F as V}from"./chunk-JZWAC4HX-Wpy6LLBq.js";import{H as E}from"./Header-DbNBnIdE.js";import{g as f,a as H,b as R,E as M,H as O}from"./listing-rules-CouRL6vW.js";const z=()=>[{title:"Edit Listing - Runoot"}],W=F(function(){var g,j,v;const{user:a,listing:N,events:u,googlePlacesApiKey:k}=L(),c=S(),t=N,[r,x]=d.useState(t.listing_type),[l,_]=d.useState(t.room_type||""),[n,w]=d.useState(t.event),[C,T]=d.useState(t.transfer_type);d.useEffect(()=>{const s=document.getElementById("description");if(s&&l==="other"){s.setCustomValidity(s.value?"":"Required");const i=()=>{s.setCustomValidity(s.value?"":"Required")};return s.addEventListener("input",i),()=>s.removeEventListener("input",i)}},[l]);const m=(()=>{if(!(n!=null&&n.event_date))return{min:void 0,max:void 0};const s=new Date(n.event_date),i=new Date(s);i.setDate(i.getDate()-7);const o=new Date(s);return o.setDate(o.getDate()+7),{min:i.toISOString().split("T")[0],max:o.toISOString().split("T")[0]}})(),h=f(a.user_type,"rooms"),p=f(a.user_type,"bibs"),D=H(a.user_type),b=R(a.user_type,C,r);return e.jsxs("div",{className:"min-h-full bg-gray-50",children:[e.jsx(E,{user:a}),e.jsxs("main",{className:"mx-auto max-w-2xl px-4 py-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(y,{to:`/listings/${t.id}`,className:"inline-flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to listing"]}),e.jsx("h1",{className:"font-display text-3xl font-bold text-gray-900",children:"Edit Listing"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Update your listing details"})]}),e.jsx("div",{className:"card p-6 sm:p-8",children:e.jsxs(V,{method:"post",className:"space-y-8",children:[(c==null?void 0:c.error)&&e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-sm text-red-700",children:c.error}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"What are you offering?"}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-3",children:[e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg border border-gray-300 bg-white p-4 shadow-sm focus:outline-none hover:border-brand-500 has-[:checked]:border-brand-500 has-[:checked]:ring-1 has-[:checked]:ring-brand-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"room",className:"sr-only",defaultChecked:r==="room",onChange:s=>x(s.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Room Only"})]})]}),e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg border border-gray-300 bg-white p-4 shadow-sm focus:outline-none hover:border-brand-500 has-[:checked]:border-brand-500 has-[:checked]:ring-1 has-[:checked]:ring-brand-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"bib",className:"sr-only",defaultChecked:r==="bib",onChange:s=>x(s.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Bib Only"})]})]}),e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg border border-gray-300 bg-white p-4 shadow-sm focus:outline-none hover:border-brand-500 has-[:checked]:border-brand-500 has-[:checked]:ring-1 has-[:checked]:ring-brand-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"room_and_bib",className:"sr-only",defaultChecked:r==="room_and_bib",onChange:s=>x(s.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Room + Bib"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Running Event"}),e.jsx(M,{events:u,defaultEventId:(g=t.event)==null?void 0:g.id,onSelectEvent:s=>{const i=u.find(o=>o.id===s);w(i)}})]}),(r==="room"||r==="room_and_bib")&&e.jsxs("div",{className:"space-y-4",id:"roomFields",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Room Details"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"label",children:"Hotel"}),e.jsx(O,{apiKey:k,eventCity:n==null?void 0:n.country,eventCountry:n==null?void 0:n.country,defaultHotelName:t.hotel_name,onSelectHotel:s=>{}})]}),e.jsx("div",{}),e.jsx("div",{}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"roomCount",className:"label",children:["Number of rooms",h!==null&&a.user_type==="tour_operator"&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(max ",h," for your account)"]})]}),a.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-brand-100 text-brand-700 font-bold text-2xl",children:"1"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Private users can list 1 room only"})]}),e.jsx("input",{type:"hidden",name:"roomCount",value:"1"})]}):e.jsx("input",{type:"number",id:"roomCount",name:"roomCount",min:"1",max:h||void 0,defaultValue:t.room_count||"",placeholder:"e.g. 2",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"roomType",className:"label",children:"Room type"}),e.jsxs("select",{id:"roomType",name:"roomType",className:"input",defaultValue:t.room_type||"",onChange:s=>_(s.target.value),children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"single",children:"Single"}),e.jsx("option",{value:"double",children:"Double"}),e.jsx("option",{value:"twin",children:"Twin"}),e.jsx("option",{value:"twin_shared",children:"Twin Shared"}),e.jsx("option",{value:"double_single_use",children:"Double Single Use"}),e.jsx("option",{value:"triple",children:"Triple"}),e.jsx("option",{value:"quadruple",children:"Quadruple"}),e.jsx("option",{value:"other",children:"Other * (specify)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"checkIn",className:"label",children:"Check-in date"}),e.jsx("input",{type:"date",id:"checkIn",name:"checkIn",defaultValue:((j=t.check_in)==null?void 0:j.split("T")[0])||"",min:m.min,max:m.max,className:"input"}),n&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Event date: ",new Date(n.event_date).toLocaleDateString()," (+/-7 days)"]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"checkOut",className:"label",children:"Check-out date"}),e.jsx("input",{type:"date",id:"checkOut",name:"checkOut",defaultValue:((v=t.check_out)==null?void 0:v.split("T")[0])||"",min:m.min,max:m.max,className:"input"})]})]})]}),(r==="bib"||r==="room_and_bib")&&e.jsxs("div",{className:"space-y-4",id:"bibFields",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Bib Transfer Details"}),a.user_type==="private"&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Important:"})," Runoot facilitates connections for legitimate bib transfers only. Direct sale of bibs may violate event regulations."]})}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"bibCount",className:"label",children:["Number of bibs",p!==null&&a.user_type==="tour_operator"&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(max ",p," for your account)"]})]}),a.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-brand-100 text-brand-700 font-bold text-2xl",children:"1"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Private users can list 1 bib only"})]}),e.jsx("input",{type:"hidden",name:"bibCount",value:"1"})]}):e.jsx("input",{type:"number",id:"bibCount",name:"bibCount",min:"1",max:p||void 0,defaultValue:t.bib_count||"",placeholder:"e.g. 1",className:"input w-full sm:w-48"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"transferType",className:"label",children:["Transfer Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),a.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-2 px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:"Official Organizer Name Change"}),e.jsx("input",{type:"hidden",name:"transferType",value:"official_process"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"How the bib will be transferred to the new participant"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{id:"transferType",name:"transferType",className:"input",defaultValue:t.transfer_type||"",onChange:s=>T(s.target.value),children:[e.jsx("option",{value:"",children:"Select transfer method"}),D.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"How the bib will be transferred to the new participant"})]})]}),b.showAssociatedCosts&&e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"associatedCosts",className:"label",children:["Associated Costs (EUR) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",id:"associatedCosts",name:"associatedCosts",min:"0",step:"0.01",defaultValue:t.associated_costs||"",placeholder:"e.g. 50",className:"input [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",required:!0}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Official name change fee from the event organizer"})]}),b.showPackageInfo&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx("strong",{children:"Package Transfer:"})," The bib is included in your travel package. All costs are included in the package price."]})})]}),!(a.user_type==="private"&&r==="bib")&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Price"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"label",children:"Price (EUR)"}),e.jsx("input",{type:"number",id:"price",name:"price",min:"0",step:"0.01",defaultValue:t.price||"",placeholder:"Empty = Contact for price",className:"input [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"})]}),(r==="room"||r==="room_and_bib")&&e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"priceNegotiable",defaultChecked:t.price_negotiable,className:"h-4 w-4 rounded border-gray-300 text-brand-600 focus:ring-brand-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Price is negotiable"})]})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"description",className:"label",children:[a.user_type==="private"&&r==="bib"?"Notes":"Additional details"," ",e.jsx("span",{className:l==="other"?"text-red-500":"text-gray-400",children:l==="other"?"(required)":"(optional)"})]}),e.jsx("textarea",{id:"description",name:"description",rows:4,defaultValue:t.description||"",placeholder:"Any other information runners should know...",className:`input ${l==="other"?"required:border-red-500 invalid:border-red-500 focus:invalid:ring-red-500":""}`,required:l==="other"})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx(y,{to:`/listings/${t.id}`,className:"btn-secondary flex-1 text-center",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary flex-1",children:"Save Changes"})]})]})})]})]})});export{W as default,z as meta};
