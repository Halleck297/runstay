import{j as t}from"./jsx-runtime-0DLF9kdB.js";import{c as v,L as y}from"./components-Oo-HIKtb.js";function _(e){const s=new Date,o=new Date(e).getTime()-s.getTime(),r=Math.ceil(o/(1e3*60*60*24));return r<=21&&r>=0}function x(e){return e?{single:"Single Room",double:"Double Room",double_single_use:"Double Single Use",twin:"Twin Room",twin_shared:"Twin Shared",triple:"Triple Room",quadruple:"Quadruple"}[e]||e:""}function k({listing:e,isUserLoggedIn:s=!0,isSaved:i=!1}){var m,d;const o=v(),r=o.formData?o.formData.get("action")==="save":i,h=new Date(e.event.event_date).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),u=e.event.name,p=_(e.event.event_date),b=e.author.user_type==="tour_operator",f=e.transfer_type==="official_process";let n="";if(e.listing_type==="bib")n=e.bib_count&&e.bib_count>1?`${e.bib_count} Bibs Available`:"Bib Available";else if(e.listing_type==="room"){const a=e.room_type?x(e.room_type):"Room";n=e.room_count&&e.room_count>1?`${e.room_count} ${a}s Available`:`${a} Available`}else n="Package Available (Room + Bib)";let l="",c="";e.listing_type==="bib"?(l="Bib",c="bg-purple-100 text-purple-700"):e.listing_type==="room"?(l="Hotel",c="bg-blue-100 text-blue-700"):(l="Package",c="bg-green-100 text-green-700");const j=b?"card p-5 hover:shadow-lg transition-all border-l-4 border-brand-500":"card p-5 hover:shadow-lg transition-all";return t.jsxs(y,{to:s?`/listings/${e.id}`:"/login",className:j,children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx("span",{className:`inline-block px-2.5 py-1 rounded-full text-xs font-medium ${c}`,children:l}),p&&t.jsx("span",{className:"inline-block px-2.5 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-700",children:"Last Minute"}),s&&t.jsxs(o.Form,{method:"post",action:"/api/saved",onClick:a=>a.stopPropagation(),className:"ml-auto",children:[t.jsx("input",{type:"hidden",name:"listingId",value:e.id}),t.jsx("input",{type:"hidden",name:"action",value:r?"unsave":"save"}),t.jsx("button",{type:"submit",onClick:a=>a.preventDefault(),onMouseDown:a=>{a.preventDefault(),a.stopPropagation(),o.submit({listingId:e.id,action:r?"unsave":"save"},{method:"post",action:"/api/saved"})},className:`p-1.5 rounded-full transition-colors ${r?"text-red-500 hover:text-red-600":"text-gray-400 hover:text-red-500"}`,title:r?"Remove from saved":"Save listing",children:t.jsx("svg",{className:"h-7 w-7",fill:r?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]})]}),t.jsx("h3",{className:"font-display text-xl font-bold text-gray-900 mb-1",children:u}),t.jsx("p",{className:"text-sm font-medium text-brand-600 mb-3",children:n}),t.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-3",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsxs("svg",{className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),t.jsx("span",{className:"font-medium",children:e.event.location})]}),t.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["ðŸ—“ Race Day: ",h]})]}),e.hotel_name&&t.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg border border-gray-100",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("svg",{className:"h-5 w-5 text-gray-500 mt-0.5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-semibold text-gray-900 text-sm leading-tight",children:e.hotel_name}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.hotel_stars&&t.jsx("span",{className:"text-yellow-500 text-sm",children:"â˜…".repeat(e.hotel_stars)}),e.hotel_rating&&t.jsxs("span",{className:"text-xs text-gray-600",children:["â­ ",e.hotel_rating.toFixed(1)]})]})]})]})}),s&&t.jsxs("div",{className:"space-y-2 mb-4",children:[(e.listing_type==="room"||e.listing_type==="room_and_bib")&&e.room_count&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[t.jsx("span",{className:"font-medium",children:"Room:"}),t.jsxs("span",{children:[e.room_type?x(e.room_type):"Room",e.room_count>1&&` Ã— ${e.room_count}`]})]}),(e.listing_type==="room"||e.listing_type==="room_and_bib")&&e.check_in&&e.check_out&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[t.jsx("span",{className:"font-medium",children:"Check-in:"}),t.jsx("span",{children:new Date(e.check_in).toLocaleDateString("en-GB",{day:"numeric",month:"short"})}),t.jsx("span",{className:"text-gray-400",children:"â†’"}),t.jsx("span",{children:new Date(e.check_out).toLocaleDateString("en-GB",{day:"numeric",month:"short"})})]}),(e.listing_type==="bib"||e.listing_type==="room_and_bib")&&e.bib_count&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[t.jsx("span",{className:"font-medium",children:"Bibs:"}),t.jsxs("span",{children:[e.bib_count,f&&t.jsx("span",{className:"text-xs text-orange-600 ml-1",children:"(name change required)"})]})]})]}),t.jsx("div",{className:"mt-6 flex items-center justify-between pt-4 border-t border-gray-100",children:s?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-gray-100 text-gray-600 text-xs font-medium",children:((m=e.author.company_name)==null?void 0:m.charAt(0))||((d=e.author.full_name)==null?void 0:d.charAt(0))||"?"}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:e.author.company_name||e.author.full_name}),e.author.is_verified&&t.jsx("svg",{className:"h-4 w-4 text-brand-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),t.jsxs("p",{className:"text-xs text-gray-500",children:[e.author.user_type==="tour_operator"?"Tour Operator":"Private seller",e.author.is_verified&&" â€¢ Verified"]})]})]}),t.jsx("div",{className:"text-right",children:e.listing_type==="bib"&&e.associated_costs?t.jsxs("p",{className:"text-lg font-bold text-gray-900",children:["â‚¬",e.associated_costs.toLocaleString()]}):e.price?t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"text-lg font-bold text-gray-900",children:["â‚¬",e.price.toLocaleString()]}),e.price_negotiable&&t.jsx("p",{className:"text-xs text-gray-500",children:"Negotiable"})]}):t.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Contact for details"})})]}):t.jsx("p",{className:"text-sm text-gray-500 italic w-full text-center",children:"Login to view seller details and pricing"})}),s&&t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:t.jsxs("button",{className:"w-full btn-primary text-sm py-2.5 flex items-center justify-center gap-2",children:[t.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),"Contact ",(e.author.company_name||e.author.full_name||"Seller").split(" ")[0]]})})]})}export{k as L};
