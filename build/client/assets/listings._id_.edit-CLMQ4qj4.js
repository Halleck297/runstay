import{w as V,u as R,a as P,c as B,r as i,j as e,L as O,F as $}from"./chunk-JZWAC4HX-Dlc7LzsC.js";import{H as A}from"./Header-DiP6E3C1.js";import{g as f,a as W,b as q,E as z,H as K,R as U,D as N,C as Y}from"./listing-rules-BUYIbtOx.js";const ee=()=>[{title:"Edit Listing - Runoot"}],te=V(function(){var j,y;const{user:r,listing:k,events:b,googlePlacesApiKey:_}=R(),c=P();B();const s=k,[a,h]=i.useState(s.listing_type),[d,w]=i.useState(s.room_type||""),[n,C]=i.useState(s.event),[D,T]=i.useState(s.transfer_type),[L,S]=i.useState(s.check_in?new Date(s.check_in):null),[F,M]=i.useState(s.currency||"EUR"),[v,E]=i.useState(((j=s.price)==null?void 0:j.toString())||""),[m,u]=i.useState(s.price_negotiable===!0?!0:s.price_negotiable===!1?!1:null);i.useEffect(()=>{const t=document.getElementById("description");if(t&&d==="other"){t.setCustomValidity(t.value?"":"Required");const o=()=>{t.setCustomValidity(t.value?"":"Required")};return t.addEventListener("input",o),()=>t.removeEventListener("input",o)}},[d]);const l=(()=>{if(!(n!=null&&n.event_date))return{min:void 0,max:void 0};const t=new Date(n.event_date),o=new Date(t);o.setDate(o.getDate()-7);const x=new Date(t);return x.setDate(x.getDate()+7),{min:o.toISOString().split("T")[0],max:x.toISOString().split("T")[0]}})(),p=f(r.user_type,"rooms"),g=f(r.user_type,"bibs"),H=W(r.user_type),I=q(r.user_type,D,a);return e.jsxs("div",{className:"min-h-full bg-gray-50",children:[e.jsx(A,{user:r}),e.jsx("div",{className:"min-h-screen bg-cover bg-center bg-no-repeat bg-fixed",style:{backgroundImage:"url('/new-listing.jpg')"},children:e.jsxs("main",{className:"mx-auto max-w-2xl px-4 py-8 pb-24 md:pb-8 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8 rounded-xl bg-white/70 backdrop-blur-sm p-4 shadow-[0_2px_8px_rgba(0,0,0,0.15)]",children:[e.jsxs(O,{to:`/listings/${s.id}`,className:"inline-flex items-center gap-2 text-sm text-gray-600 hover:text-gray-900 mb-4 underline",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to listing"]}),e.jsx("h1",{className:"font-display text-3xl font-bold text-gray-900",children:"Edit Listing"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Update your listing details"})]}),e.jsx("div",{className:"rounded-2xl bg-white/90 backdrop-blur-sm p-6 sm:p-8 shadow-[0_2px_8px_rgba(0,0,0,0.15)]",children:e.jsxs($,{method:"post",className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"What are you offering?"}),e.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-3",children:[e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg bg-white p-4 shadow-sm focus:outline-none transition-all hover:ring-2 hover:ring-blue-300 has-[:checked]:bg-blue-100 has-[:checked]:ring-2 has-[:checked]:ring-blue-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"room",className:"sr-only",defaultChecked:a==="room",onChange:t=>h(t.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Room Only"})]})]}),e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg bg-white p-4 shadow-sm focus:outline-none transition-all hover:ring-2 hover:ring-purple-300 has-[:checked]:bg-purple-100 has-[:checked]:ring-2 has-[:checked]:ring-purple-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"bib",className:"sr-only",defaultChecked:a==="bib",onChange:t=>h(t.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Bib Only"})]})]}),e.jsxs("label",{className:"relative flex cursor-pointer rounded-lg bg-white p-4 shadow-sm focus:outline-none transition-all hover:ring-2 hover:ring-green-300 has-[:checked]:bg-green-100 has-[:checked]:ring-2 has-[:checked]:ring-green-500",children:[e.jsx("input",{type:"radio",name:"listingType",value:"room_and_bib",className:"sr-only",defaultChecked:a==="room_and_bib",onChange:t=>h(t.target.value)}),e.jsxs("span",{className:"flex flex-1 flex-col items-center text-center",children:[e.jsx("svg",{className:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("span",{className:"mt-2 text-sm font-medium text-gray-900",children:"Room + Bib"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Running Event"}),e.jsx(z,{events:b,defaultEventId:(y=s.event)==null?void 0:y.id,onSelectEvent:t=>{const o=b.find(x=>x.id===t);C(o)}})]}),(a==="room"||a==="room_and_bib")&&e.jsxs("div",{className:"space-y-4",id:"roomFields",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Room Details"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"label",children:"Hotel"}),e.jsx(K,{apiKey:_,eventCity:n==null?void 0:n.country,eventCountry:n==null?void 0:n.country,defaultHotelName:s.hotel_name,onSelectHotel:t=>{}})]}),e.jsx("div",{}),e.jsx("div",{}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"roomCount",className:"label",children:["Number of rooms",p!==null&&r.user_type==="tour_operator"&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(max ",p," for your account)"]})]}),r.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-lg font-bold text-2xl shadow-[0_2px_8px_rgba(0,0,0,0.15)] ${a==="room"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:"1"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Private users can list",e.jsx("br",{}),"1 room only"]})]}),e.jsx("input",{type:"hidden",name:"roomCount",value:"1"})]}):e.jsx("input",{type:"number",id:"roomCount",name:"roomCount",min:"1",max:p||void 0,defaultValue:s.room_count||"",placeholder:"e.g. 2",className:"input"})]}),e.jsx(U,{value:d,onChange:w,hasError:(c==null?void 0:c.field)==="roomType"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"checkIn",className:"label mb-3",children:"Check-in"}),e.jsx(N,{id:"checkIn",name:"checkIn",placeholder:"dd/mm/yyyy",defaultValue:s.check_in||void 0,minDate:l.min?new Date(l.min):void 0,maxDate:l.max?new Date(l.max):void 0,onChange:t=>S(t)}),n&&e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Event date: ",new Date(n.event_date).toLocaleDateString()," (Â±7 days)"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"checkOut",className:"label mb-3",children:"Check-out"}),e.jsx(N,{id:"checkOut",name:"checkOut",placeholder:"dd/mm/yyyy",defaultValue:s.check_out||void 0,minDate:L||(l.min?new Date(l.min):void 0),maxDate:l.max?new Date(l.max):void 0})]})]})]}),(a==="bib"||a==="room_and_bib")&&e.jsxs("div",{className:"space-y-4",id:"bibFields",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Bib Transfer Details"}),r.user_type==="private"&&e.jsx("div",{className:`rounded-lg p-4 ${a==="bib"?"bg-purple-50 border border-purple-200":"bg-green-50 border border-green-200"}`,children:e.jsxs("p",{className:`text-sm ${a==="bib"?"text-purple-800":"text-green-800"}`,children:[e.jsx("strong",{children:"Important:"})," runoot facilitates connections for legitimate bib transfers only. Direct sale of bibs may violate event regulations."]})}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"bibCount",className:"label",children:["Number of bibs",g!==null&&r.user_type==="tour_operator"&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(max ",g," for your account)"]})]}),r.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("div",{className:`flex h-12 w-12 items-center justify-center rounded-lg font-bold text-2xl shadow-[0_2px_8px_rgba(0,0,0,0.15)] ${a==="bib"?"bg-purple-100 text-purple-700":"bg-green-100 text-green-700"}`,children:"1"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Private users can list 1 bib only"})]}),e.jsx("input",{type:"hidden",name:"bibCount",value:"1"})]}):e.jsx("input",{type:"number",id:"bibCount",name:"bibCount",min:"1",max:g||void 0,defaultValue:s.bib_count||"",placeholder:"e.g. 1",className:"input w-full sm:w-48"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"transferType",className:"label",children:["Transfer Method ",e.jsx("span",{className:"text-red-500",children:"*"})]}),r.user_type==="private"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-2 px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-lg text-gray-700",children:"Official Organizer Name Change"}),e.jsx("input",{type:"hidden",name:"transferType",value:"official_process"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"How the bib will be transferred to the new participant"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("select",{id:"transferType",name:"transferType",className:"input",defaultValue:s.transfer_type||"",onChange:t=>T(t.target.value),children:[e.jsx("option",{value:"",children:"Select transfer method"}),H.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"How the bib will be transferred to the new participant"})]})]}),I.showPackageInfo&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx("strong",{children:"Package Transfer:"})," The bib is included in your travel package. All costs are included in the package price."]})})]}),!(r.user_type==="private"&&a==="bib")&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 border-b pb-2",children:"Price"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"price",className:"label mb-3",children:"Amount"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"number",id:"price",name:"price",min:"0",step:"0.01",placeholder:"Empty = Contact for price",className:"input w-[205px] [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none placeholder:text-sm placeholder:font-sans",value:v,onChange:t=>{E(t.target.value),t.target.value||u(null)}}),e.jsx(Y,{value:F,onChange:M})]})]}),v&&(a==="room"||a==="room_and_bib")&&e.jsxs("div",{className:"mt-4",children:[e.jsx("input",{type:"hidden",name:"priceNegotiable",value:m===!0?"true":"false"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Is the price negotiable?"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>u(m===!0?null:!0),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${m===!0?"bg-green-100 text-green-700 ring-2 ring-green-500 shadow-[0_2px_8px_rgba(0,0,0,0.15)]":"bg-white text-gray-700 shadow-sm hover:ring-2 hover:ring-green-300"}`,children:"Yes"}),e.jsx("button",{type:"button",onClick:()=>u(m===!1?null:!1),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${m===!1?"bg-green-100 text-green-700 ring-2 ring-green-500 shadow-[0_2px_8px_rgba(0,0,0,0.15)]":"bg-white text-gray-700 shadow-sm hover:ring-2 hover:ring-green-300"}`,children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"description",className:"label",children:[r.user_type==="private"&&a==="bib"?"Notes":"Additional details"," ",e.jsx("span",{className:d==="other"?"text-red-500":"text-gray-400",children:d==="other"?"(required)":"(optional)"})]}),e.jsx("textarea",{id:"description",name:"description",rows:4,defaultValue:s.description||"",placeholder:"Any other information runners should know...",className:`input ${d==="other"?"required:border-red-500 invalid:border-red-500 focus:invalid:ring-red-500":""}`,required:d==="other"})]}),(c==null?void 0:c.error)&&e.jsxs("div",{className:"rounded-lg bg-red-50 border border-red-200 p-4 text-sm text-red-700 flex items-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5 text-red-500 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),c.error]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",className:"btn-primary w-full rounded-full",children:"Save Changes"})})]})})]})})]})});export{te as default,ee as meta};
