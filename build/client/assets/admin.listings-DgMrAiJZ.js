import{w as b,u as v,a as f,f as N,j as e,F as n,L as x}from"./chunk-JZWAC4HX-Dlc7LzsC.js";const _=()=>[{title:"Listings - Admin - Runoot"}],j={room:{label:"Hotel",color:"bg-blue-100 text-blue-700"},bib:{label:"Bib",color:"bg-purple-100 text-purple-700"},room_and_bib:{label:"Package",color:"bg-green-100 text-green-700"}},y={pending:"bg-yellow-100 text-yellow-700",active:"bg-success-100 text-success-700",sold:"bg-gray-100 text-gray-600",expired:"bg-alert-100 text-alert-700",rejected:"bg-red-100 text-red-700"},L=b(function(){const{listings:m,totalCount:g,currentPage:l,totalPages:p}=v(),u=f(),[s]=N();return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"font-display text-2xl md:text-3xl font-bold text-gray-900",children:"Listings"}),e.jsxs("p",{className:"text-gray-500 mt-1",children:[g," total listings"]})]}),u&&"error"in u&&e.jsx("div",{className:"mb-4 p-3 rounded-lg bg-alert-50 text-alert-700 text-sm",children:u.error}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-4 mb-6",children:e.jsxs(n,{method:"get",className:"flex flex-col md:flex-row gap-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",name:"search",placeholder:"Search by title...",defaultValue:s.get("search")||"",className:"input w-full"})}),e.jsxs("select",{name:"status",defaultValue:s.get("status")||"",className:"input",children:[e.jsx("option",{value:"",children:"All statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"sold",children:"Sold"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsxs("select",{name:"type",defaultValue:s.get("type")||"",className:"input",children:[e.jsx("option",{value:"",children:"All types"}),e.jsx("option",{value:"room",children:"Hotel"}),e.jsx("option",{value:"bib",children:"Bib"}),e.jsx("option",{value:"room_and_bib",children:"Package"})]}),e.jsx("button",{type:"submit",className:"btn-accent",children:"Search"})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider px-6 py-3",children:"Listing"}),e.jsx("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider px-6 py-3",children:"Author"}),e.jsx("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider px-6 py-3",children:"Type"}),e.jsx("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider px-6 py-3",children:"Status"}),e.jsx("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider px-6 py-3",children:"Event"}),e.jsx("th",{className:"text-left text-xs font-medium text-gray-500 uppercase tracking-wider px-6 py-3",children:"Created"}),e.jsx("th",{className:"text-right text-xs font-medium text-gray-500 uppercase tracking-wider px-6 py-3",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:m.map(t=>{var i,c,o,a;const d=j[t.listing_type]||{label:t.listing_type,color:"bg-gray-100 text-gray-600"};return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx(x,{to:`/listings/${t.id}`,className:"text-sm font-medium text-gray-900 hover:text-brand-600",children:t.title}),t.price&&e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[t.currency," ",t.price,t.price_negotiable&&" (negotiable)"]})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-sm text-gray-700",children:((i=t.author)==null?void 0:i.company_name)||((c=t.author)==null?void 0:c.full_name)||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-400",children:(o=t.author)==null?void 0:o.email})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${d.color}`,children:d.label})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs(n,{method:"post",className:"inline",children:[e.jsx("input",{type:"hidden",name:"_action",value:"changeStatus"}),e.jsx("input",{type:"hidden",name:"listingId",value:t.id}),e.jsxs("select",{name:"newStatus",defaultValue:t.status,onChange:r=>{var h;return(h=r.target.form)==null?void 0:h.requestSubmit()},className:`text-xs font-medium px-2 py-1 rounded-full border-0 cursor-pointer ${y[t.status]||""}`,children:[e.jsx("option",{value:"pending",children:"pending"}),e.jsx("option",{value:"active",children:"active"}),e.jsx("option",{value:"sold",children:"sold"}),e.jsx("option",{value:"expired",children:"expired"}),e.jsx("option",{value:"rejected",children:"rejected"})]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:((a=t.event)==null?void 0:a.name)||"—"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsxs(n,{method:"post",className:"inline",children:[e.jsx("input",{type:"hidden",name:"_action",value:"impersonateAuthor"}),e.jsx("input",{type:"hidden",name:"authorId",value:t.author_id}),e.jsx("button",{type:"submit",className:"text-xs font-medium text-navy-500 hover:text-navy-700 px-2 py-1 rounded hover:bg-gray-100",title:"Impersonate author",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),e.jsxs(n,{method:"post",className:"inline",onSubmit:r=>{confirm("Are you sure you want to delete this listing?")||r.preventDefault()},children:[e.jsx("input",{type:"hidden",name:"_action",value:"delete"}),e.jsx("input",{type:"hidden",name:"listingId",value:t.id}),e.jsx("button",{type:"submit",className:"text-xs font-medium text-alert-500 hover:text-alert-700 px-2 py-1 rounded hover:bg-alert-50",title:"Delete listing",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})})]},t.id)})})]})}),e.jsx("div",{className:"md:hidden divide-y divide-gray-100",children:m.map(t=>{var i,c,o;const d=j[t.listing_type]||{label:t.listing_type,color:"bg-gray-100 text-gray-600"};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(x,{to:`/listings/${t.id}`,className:"text-sm font-medium text-gray-900 hover:text-brand-600",children:t.title}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["by ",((i=t.author)==null?void 0:i.company_name)||((c=t.author)==null?void 0:c.full_name)||"Unknown"]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${d.color}`,children:d.label}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${y[t.status]||""}`,children:t.status})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:[(o=t.event)==null?void 0:o.name," · ",new Date(t.created_at).toLocaleDateString(),t.price&&e.jsxs("span",{children:[" · ",t.currency," ",t.price]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(n,{method:"post",className:"inline",children:[e.jsx("input",{type:"hidden",name:"_action",value:"changeStatus"}),e.jsx("input",{type:"hidden",name:"listingId",value:t.id}),e.jsxs("select",{name:"newStatus",defaultValue:t.status,onChange:a=>{var r;return(r=a.target.form)==null?void 0:r.requestSubmit()},className:"text-xs px-2 py-1 rounded bg-gray-50 border-0",children:[e.jsx("option",{value:"active",children:"active"}),e.jsx("option",{value:"sold",children:"sold"}),e.jsx("option",{value:"expired",children:"expired"})]})]}),e.jsxs(n,{method:"post",className:"inline",onSubmit:a=>{confirm("Delete this listing?")||a.preventDefault()},children:[e.jsx("input",{type:"hidden",name:"_action",value:"delete"}),e.jsx("input",{type:"hidden",name:"listingId",value:t.id}),e.jsx("button",{type:"submit",className:"text-xs text-alert-500 px-2 py-1 rounded bg-gray-50",children:"Delete"})]})]})]})]},t.id)})}),m.length===0&&e.jsx("div",{className:"p-8 text-center text-gray-400 text-sm",children:"No listings found"})]}),p>1&&e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-2",children:[l>1&&e.jsx(x,{to:`/admin/listings?page=${l-1}&search=${s.get("search")||""}&status=${s.get("status")||""}&type=${s.get("type")||""}`,className:"px-3 py-2 text-sm rounded-lg border border-gray-200 hover:bg-gray-50",children:"Previous"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Page ",l," of ",p]}),l<p&&e.jsx(x,{to:`/admin/listings?page=${l+1}&search=${s.get("search")||""}&status=${s.get("status")||""}&type=${s.get("type")||""}`,className:"px-3 py-2 text-sm rounded-lg border border-gray-200 hover:bg-gray-50",children:"Next"})]})]})});export{L as default,_ as meta};
