import{e as v,j as t,L as j}from"./chunk-JZWAC4HX-Dlc7LzsC.js";function y(e){const r=new Date,o=new Date(e).getTime()-r.getTime(),s=Math.ceil(o/(1e3*60*60*24));return s<=21&&s>=0}function g(e){return e?{single:"Single",double:"Double",double_single_use:"Double SU",twin:"Twin",twin_shared:"Twin Shared",triple:"Triple",quadruple:"Quad"}[e]||e:"Room"}function N(e){return e.slug?e.slug:e.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")}function L({listing:e,isUserLoggedIn:r=!0,isSaved:c=!1}){var i,d;const o=v(),s=o.formData?o.formData.get("action")==="save":c,m=new Date(e.event.event_date).toLocaleDateString("en-GB",{day:"numeric",month:"short"}),x=y(e.event.event_date),u=e.author.user_type==="tour_operator";let n="";if(e.listing_type==="bib")n=e.bib_count&&e.bib_count>1?`${e.bib_count} Bibs`:"Bib";else if(e.listing_type==="room"){const a=e.room_type?g(e.room_type):"Room";n=e.room_count&&e.room_count>1?`${e.room_count} ${a}s`:a}else n="Room + Bib";let l="";e.listing_type==="bib"?l="bg-purple-100 text-purple-700":e.listing_type==="room"?l="bg-blue-100 text-blue-700":l="bg-green-100 text-green-700";const h=u?"block bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md hover:border-brand-300 transition-all border-l-4 border-l-brand-500":"block bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md hover:border-brand-300 transition-all",p=(e.author.company_name||e.author.full_name||"Seller").split(" ")[0],b=`/logos/${N(e.event)}.png`;return t.jsxs(j,{to:r?`/listings/${e.id}`:"/login",className:`${h} relative`,children:[r&&t.jsx("div",{className:"absolute top-3 right-3 z-10",children:t.jsxs(o.Form,{method:"post",action:"/api/saved",onClick:a=>a.stopPropagation(),children:[t.jsx("input",{type:"hidden",name:"listingId",value:e.id}),t.jsx("input",{type:"hidden",name:"action",value:s?"unsave":"save"}),t.jsx("button",{type:"submit",onClick:a=>a.preventDefault(),onMouseDown:a=>{a.preventDefault(),a.stopPropagation(),o.submit({listingId:e.id,action:s?"unsave":"save"},{method:"post",action:"/api/saved"})},className:`p-1 rounded-full transition-colors ${s?"text-red-500":"text-gray-400 hover:text-red-500"}`,title:s?"Remove from saved":"Save listing",children:t.jsx("svg",{className:"h-5 w-5",fill:s?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]})}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold ${l}`,children:e.listing_type==="bib"?"Bib":e.listing_type==="room"?"Hotel":"Package"}),x&&t.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-semibold bg-accent-100 text-accent-700",children:"LM"})]}),t.jsx("h3",{className:"font-display text-base font-bold text-gray-900 leading-tight mb-0.5 line-clamp-1",children:e.event.name}),t.jsx("p",{className:"text-sm font-medium text-brand-600",children:n}),e.hotel_name&&t.jsx("p",{className:"text-sm text-gray-600 mb-2 truncate",children:e.hotel_name}),!e.hotel_name&&t.jsx("div",{className:"mb-2"}),t.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600 mb-2",children:[t.jsx("svg",{className:"h-3.5 w-3.5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),t.jsxs("span",{className:"font-medium",children:["Race Day: ",m]})]})]}),t.jsx("div",{className:"flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden bg-gray-100 flex items-center justify-center self-center",children:t.jsx("img",{src:b,alt:`${e.event.name} logo`,className:"w-full h-full object-contain p-1",onError:a=>{const f=a.target;f.style.display="none"}})})]}),t.jsx("div",{className:"flex items-center pt-2 border-t border-gray-100",children:r?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[t.jsx("div",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-gray-100 text-gray-600 text-xs font-medium flex-shrink-0",children:((i=e.author.company_name)==null?void 0:i.charAt(0))||((d=e.author.full_name)==null?void 0:d.charAt(0))||"?"}),t.jsxs("div",{className:"min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"text-xs font-semibold text-gray-900 truncate",children:p}),e.author.is_verified&&t.jsx("svg",{className:"h-3.5 w-3.5 text-brand-500 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),t.jsx("p",{className:"text-[10px] text-gray-500",children:e.author.user_type==="tour_operator"?"Tour Operator":"Private"})]})]}),t.jsx("div",{className:"flex-1 flex justify-center",children:t.jsx("span",{className:"bg-accent-500 text-white text-xs font-medium px-4 py-1.5 rounded-full",children:"View"})}),t.jsx("div",{className:"text-right flex-1 flex justify-end",children:e.listing_type==="bib"&&e.associated_costs?t.jsxs("p",{className:"text-base font-bold text-gray-900",children:["€",e.associated_costs.toLocaleString()]}):e.price?t.jsxs("p",{className:"text-base font-bold text-gray-900",children:["€",e.price.toLocaleString()]}):t.jsx("p",{className:"text-xs font-medium text-gray-600",children:"Contact"})})]}):t.jsx("p",{className:"text-xs text-gray-500 italic w-full text-center",children:"Login to view details"})})]})}export{L};
