import{j as e}from"./jsx-runtime-0DLF9kdB.js";import{r as i}from"./components-Oo-HIKtb.js";function I({events:s,onSelectEvent:r,defaultEventId:d}){const[c,l]=i.useState(!1),[t,x]=i.useState(""),[o,p]=i.useState(()=>d&&s.find(a=>a.id===d)||null),[m,u]=i.useState(!1),g=s.filter(a=>a.name.toLowerCase().includes(t.toLowerCase())||a.location.toLowerCase().includes(t.toLowerCase())),f=a=>{p(a),l(!1),r(a.id)};return e.jsxs("div",{children:[e.jsx("input",{type:"hidden",name:"eventId",value:(o==null?void 0:o.id)||""}),o?e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-green-500 bg-green-50 p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Event: ",o.name]}),e.jsxs("p",{className:"text-xs text-gray-600",children:[o.location," â€¢ ",new Date(o.event_date).getFullYear()]})]})]}),e.jsx("button",{type:"button",onClick:()=>l(!0),className:"text-sm text-brand-600 hover:text-brand-700 font-medium",children:"Change"})]}):e.jsx("button",{type:"button",onClick:()=>l(!0),className:"input text-left text-gray-500 hover:border-brand-500",children:"Choose your event..."}),c&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 transition-opacity",onClick:()=>l(!1)}),e.jsxs("div",{className:"relative w-full max-w-2xl rounded-lg bg-white shadow-xl",children:[e.jsxs("div",{className:"border-b border-gray-200 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Choose your event"}),e.jsx("button",{type:"button",onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{type:"text",placeholder:"Search by event name, city...",value:t,onChange:a=>x(a.target.value),className:"input",autoFocus:!0})})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto px-6 py-4",children:g.length>0?e.jsx("div",{className:"space-y-2",children:g.map(a=>e.jsxs("button",{type:"button",onClick:()=>f(a),className:"w-full rounded-lg border border-gray-200 p-4 text-left transition-colors hover:border-brand-500 hover:bg-brand-50",children:[e.jsx("p",{className:"font-medium text-gray-900",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[a.location," â€¢ ",new Date(a.event_date).getFullYear()]})]},a.id))}):e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Can't find your event?"}),e.jsx("button",{type:"button",onClick:()=>{u(!0),l(!1)},className:"mt-2 text-sm font-medium text-brand-600 hover:text-brand-700",children:"+ Add a new one"})]})})]})]})}),m&&e.jsxs("div",{className:"mt-4 rounded-lg border border-brand-200 bg-brand-50 p-4",children:[e.jsx("h3",{className:"mb-4 font-medium text-gray-900",children:"Create New Event"}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newEventName",className:"label",children:"Event name"}),e.jsx("input",{type:"text",id:"newEventName",name:"newEventName",placeholder:"e.g. Berlin Marathon 2025",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newEventDate",className:"label",children:"Event date"}),e.jsx("input",{type:"date",id:"newEventDate",name:"newEventDate",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newEventLocation",className:"label",children:"City"}),e.jsx("input",{type:"text",id:"newEventLocation",name:"newEventLocation",placeholder:"e.g. Berlin",className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newEventCountry",className:"label",children:"Country"}),e.jsx("input",{type:"text",id:"newEventCountry",name:"newEventCountry",placeholder:"e.g. Germany",className:"input"})]})]}),e.jsx("button",{type:"button",onClick:()=>u(!1),className:"mt-4 text-sm text-gray-600 hover:text-gray-800",children:"Cancel"})]})]})}function A({onSelectHotel:s,apiKey:r,eventCity:d,eventCountry:c,defaultHotelName:l}){const[t,x]=i.useState(()=>l?{placeId:"",name:l,city:"",country:"",formattedAddress:""}:null),[o,p]=i.useState(!1),m=i.useRef(null),u=i.useRef(null);i.useEffect(()=>{if(!m.current||!r)return;const a=async()=>{if(window.google)h();else{const n=document.createElement("script");n.src=`https://maps.googleapis.com/maps/api/js?key=${r}&libraries=places`,n.async=!0,n.defer=!0,document.head.appendChild(n),n.onload=()=>{h()}}},h=()=>{if(m.current){if(u.current=new google.maps.places.Autocomplete(m.current,{types:["lodging"],fields:["place_id","name","formatted_address","address_components","geometry","rating","website"]}),d&&c){const n=F(c);n&&u.current.setComponentRestrictions({country:n})}u.current.addListener("place_changed",()=>{var w,C,k,L,E,S;const n=(w=u.current)==null?void 0:w.getPlace();if(!n||!n.place_id)return;let b="",v="";(C=n.address_components)==null||C.forEach(y=>{y.types.includes("locality")&&(b=y.long_name),y.types.includes("country")&&(v=y.long_name)});const N={placeId:n.place_id,name:n.name||"",city:b,country:v,formattedAddress:n.formatted_address||"",lat:(L=(k=n.geometry)==null?void 0:k.location)==null?void 0:L.lat(),lng:(S=(E=n.geometry)==null?void 0:E.location)==null?void 0:S.lng(),rating:n.rating,website:n.website};x(N),s(N)})}};a()},[r,s]);const g=()=>{x(null),s(null)},f=a=>{a.preventDefault();const h=new FormData(a.currentTarget),n={placeId:"",name:h.get("manualHotelName"),city:h.get("manualCity"),country:h.get("manualCountry"),formattedAddress:""};x(n),s(n),p(!1)};return e.jsx("div",{children:t?e.jsxs("div",{className:"flex items-center justify-between rounded-lg border border-green-500 bg-green-50 p-4",children:[e.jsx("input",{type:"hidden",name:"hotelPlaceId",value:(t==null?void 0:t.placeId)||""}),e.jsx("input",{type:"hidden",name:"hotelName",value:(t==null?void 0:t.name)||""}),e.jsx("input",{type:"hidden",name:"hotelCity",value:(t==null?void 0:t.city)||""}),e.jsx("input",{type:"hidden",name:"hotelCountry",value:(t==null?void 0:t.country)||""}),e.jsx("input",{type:"hidden",name:"hotelLat",value:(t==null?void 0:t.lat)||""}),e.jsx("input",{type:"hidden",name:"hotelLng",value:(t==null?void 0:t.lng)||""}),e.jsx("input",{type:"hidden",name:"hotelRating",value:(t==null?void 0:t.rating)||""}),e.jsx("input",{type:"hidden",name:"hotelWebsite",value:(t==null?void 0:t.website)||""}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:["Hotel: ",t.name]}),e.jsxs("p",{className:"text-xs text-gray-600",children:[t.city,t.country?`, ${t.country}`:"",t.rating&&` â€¢ â­ ${t.rating}`,t.website&&" â€¢ ðŸŒ Website available"]})]})]}),e.jsx("button",{type:"button",onClick:g,className:"text-sm text-brand-600 hover:text-brand-700 font-medium",children:"Change"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"hidden",name:"hotelPlaceId",value:""}),e.jsx("input",{type:"hidden",name:"hotelName",value:""}),e.jsx("input",{type:"hidden",name:"hotelCity",value:""}),e.jsx("input",{type:"hidden",name:"hotelCountry",value:""}),e.jsx("input",{type:"hidden",name:"hotelLat",value:""}),e.jsx("input",{type:"hidden",name:"hotelLng",value:""}),e.jsx("input",{type:"hidden",name:"hotelRating",value:""}),e.jsx("input",{type:"hidden",name:"hotelWebsite",value:""}),e.jsx("input",{ref:m,type:"text",placeholder:"Start typing hotel name or city...",className:"input",onChange:g}),e.jsx("button",{type:"button",onClick:()=>p(!o),className:"mt-2 inline-flex items-center gap-2 rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-brand-500 focus:ring-offset-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Use autocomplete instead"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add hotel manually"]})}),o&&e.jsxs("form",{onSubmit:f,className:"mt-4 space-y-3 rounded-lg border border-gray-200 bg-gray-50 p-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manualHotelName",className:"label text-sm",children:"Hotel name *"}),e.jsx("input",{type:"text",id:"manualHotelName",name:"manualHotelName",required:!0,className:"input",placeholder:"e.g. Hotel Artemide"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manualCity",className:"label text-sm",children:"City *"}),e.jsx("input",{type:"text",id:"manualCity",name:"manualCity",required:!0,className:"input",placeholder:"e.g. Rome"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"manualCountry",className:"label text-sm",children:"Country *"}),e.jsx("input",{type:"text",id:"manualCountry",name:"manualCountry",required:!0,className:"input",placeholder:"e.g. Italy"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-primary text-sm",children:"Save hotel"}),e.jsx("button",{type:"button",onClick:()=>p(!1),className:"text-sm text-gray-600 hover:text-gray-800",children:"Cancel"})]})]})]})})}function F(s){return{Italy:"IT",Germany:"DE",USA:"US","United States":"US",UK:"GB","United Kingdom":"GB",France:"FR",Spain:"ES",Japan:"JP",Netherlands:"NL"}[s]||""}const j={private:{maxRooms:1,maxBibs:1,allowedTransferMethods:["official_process"],description:"Exchange platform for individual runners"},tour_operator:{maxRooms:null,maxBibs:null,allowedTransferMethods:["official_process","package"],description:"Business platform for tour operators"}};function B(s,r){return r==="rooms"?j[s].maxRooms:j[s].maxBibs}function R(s){const r=j[s].allowedTransferMethods,d={official_process:"Official organizer name change",package:"Included in travel package",contact:"Contact for details"};return r.map(c=>({value:c,label:d[c]}))}function P(s,r,d){return r?r==="official_process"?{showAssociatedCosts:d==="bib"&&s==="private",showCostNotes:!1,showPackageInfo:!1}:r==="package"?{showAssociatedCosts:!1,showCostNotes:!1,showPackageInfo:!0}:{showAssociatedCosts:!1,showCostNotes:!1,showPackageInfo:!1}:{showAssociatedCosts:!1,showCostNotes:!1,showPackageInfo:!1}}export{I as E,A as H,R as a,P as b,B as g};
